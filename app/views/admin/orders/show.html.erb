<p id="notice"><%= notice %></p>

<div class="card card-default">
                <div class="card-body">

            <%= link_to show_from_pdf_admin_order_path(@order, format: :pdf), :class => "btn btn-sm btn-info", target: :_blank do %>
                <em class="fas fa-print"></em> 
            <%end%>

            <%= link_to admin_orders_path, :class => "btn btn-sm btn-info" do %>
                <em class="fas fa-step-backward"></em> 
            <%end%>
            
            <% if @order.sale.bill_state != "invoiced" %>
            <%= link_to bill_admin_order_path(@order), :class => "btn btn-sm btn-info", remote: true   do %>
                <em class="fa-1x far fa-money-bill-alt"></em> Facturar
            <% end %>
            <% end %>

            <a class="btn btn-sm btn-info" target="_blank" href="https://portalsat.plataforma.sat.gob.mx/ConsultaRFC/" >
                <em class="fa-1x mr-2 fas fa-external-link-alt"></em> Verificar RFC
            </a>

            <%= link_to request_cancel_invoice_admin_order_path(@order), :class => "btn btn-sm btn-info", remote: true   do %>
                <em class="fa-1x far fa-money-bill-alt"></em> Cancelar
            <% end %>


     
            <% if @order.sale.bill_state == "invoiced" %>     
            <br><span class="badge badge-success">Facturado</span>
            <% end %>
                </div>
  <div class="card-body">
<div class="invoice-box">
        <table cellpadding="0" cellspacing="0">
          <tr class="top">
            <td colspan="5">
              <table>
                <tr>
                  <td class="title">
                    <%= image_tag 'pdf/logo.png' %>
                  </td>

                  <td>
                    <strong>Toposervis S de RL de CV</strong>
                    <br>
                    <span>Calle42No.264x41Ay 41C</span>
                    <br>
                    <span>Fraccionamiento Francisco de MontejoIII Mérida,Yucatán </span>
                    <br>
                    <span>Tel. 01 800 890 9383 CP 97203</span>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        

          <tr class="information">
            <td colspan="5">
              <table>
                <tr>
                  <td>
                    <b>Contacto:</b>
                    <%= @order.customer.customer_contacts.first.name %><br>
                    <b>Compañia:</b>
                    <%= @order.customer.business_name %><br>
                    <b>E-mail:</b>
                    <%= @order.customer.customer_contacts.first.email %><br>
                    <b>Método de pago:</b>
                    <%= @order.sale.payment_method.name %><br>
                    <b>Forma de pago:</b>
                    <%= @order.sale.payment_way.name %>
                  </td>
                  <td>
                    <b>Nota de venta</b><br>
                    <b>Folio:</b>
                    <%= @order.sale.folio %><br>
                    <b>Fecha:</b>
                    <%= @order.created_at.strftime("%d-%m-%Y") %>
                  </td>

                </tr>
              </table>
            </td>
          </tr>

          <tr class="heading">
            <td>Concepto</td>
            <td class="right">Unidad</td>
            <td class="right">Precio</td>
            <td class="right">Cantidad</td>
            <td>Total</td>
          </tr>

          <% @order.items.each do |item| %>
            <tr class="item">
                <td>
                    <%= item.name %><br>
                    <small><%= item.extended_description %></small>
                </td>

                <td class="right">
                    <%= item.unit %>
                </td>

                <td class="right">
                    <%= number_to_currency(item.unit_price) %>
                </td>

                <td class="right">
                    x <%= item.quantity %>
                </td>

                <td>
                    <%= number_to_currency(item.unit_price * item.quantity) %>
                </td>
            </tr>
          <% end %>



          <tr>
            <td colspan="5"></td>
          </tr>

          <tr>
            <td colspan="3"></td>
            <td><b>Subtotal</b></td>
            <td><%= number_to_currency(@order.subtotal) %></td>
          </tr>

          <tr>
            <td colspan="3"></td>
            <% if @order.adjustment_total != 0 %>
            <td><b>Descuento</b></td>
            <td>- <%= number_to_currency(@order.adjustment_total) %></td>
            <% end %>
          </tr>

          <tr>
            <td colspan="3"></td>
            <td><b>Impuesto (<%= (@order.tax * 100).to_i %>%)</b></td>
            <td>+ <%= number_to_currency(@order.tax_total) %></td>
          </tr>

          <tr class="heading">
            <td colspan="3"></td>
            <td><b>TOTAL:</b></td>
            <td>
               <b><%= number_to_currency(@order.total) %></b>
            </td>
          </tr>

          <tr>
            <td colspan="5">
              <table>
            <tr class="footer">
              <td colspan="1"></td>
              <td colspan="2" class="footer" style="text-align: center;">
                <b>www.toposervis.com</b></br>
                <b>Venta, renta de equipos y servicios de topografía e ingeniería<b></br>
                <b>Tel. 01 800 890 9383<b></br>
              </td>         
              <td colspan="2"></td>
          </tr> 
              </table>
            </td>
          </tr>          
          
        </table>
    </div>
</div>
</div>

<style type="text/css">
// Place all the styles related to the Conditions controller here.
// They will automatically be included in application.css.
// You can use Sass (SCSS) here: http://sass-lang.com/

.invoice-box {
    max-width: 100%;
    max-height: 100%;
    margin: auto;
    padding: 30px;
    border: 1px solid #eee;
    box-shadow: 0 0 5px rgba(0, 0, 0, .10);
    font-size: 16px;
    line-height: 24px;
    font-family: 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
    color: #555;
}

.invoice-box table {
    width: 100%;
    line-height: inherit;
    text-align: left;
}

.invoice-box table td {
    padding: 5px;
    vertical-align: middle;
}

.invoice-box table tr td:nth-child(2) {
    text-align: right;
}

.right {
  text-align: right;
}

.invoice-box table tr.top table td {
    padding-bottom: 20px;
}

.invoice-box table tr.top table td.title {
    font-size: 45px;
    line-height: 45px;
    color: #333;
}

.invoice-box table tr.information table td {
    padding-bottom: 40px;
}

.invoice-box table tr.heading td {
    background: #eee;
    border-bottom: 1px solid #ddd;
    font-weight: bold;
}

.invoice-box table tr.details td {
    padding-bottom: 20px;
}

.invoice-box table tr.item td{
    border-bottom: 1px solid #eee;
}

.invoice-box table tr.item.last td {
    border-bottom: none;
}

.badge {
  display: inline-block;
  padding: 0.25em 0.4em;
  font-size: 75%;
  font-weight: 700;
  line-height: 1;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: 0.25rem;
}
.badge:empty {
  display: none;
}

.btn .badge {
  position: relative;
  top: -1px;
}

.badge-pill {
  padding-right: 0.6em;
  padding-left: 0.6em;
  border-radius: 10rem;
}

.badge-primary {
  color: #fff;
  background-color: #007bff;
}

.badge-primary[href]:hover, .badge-primary[href]:focus {
  color: #fff;
  text-decoration: none;
  background-color: #0062cc;
}

.badge-secondary {
  color: #fff;
  background-color: #6c757d;
}

.badge-secondary[href]:hover, .badge-secondary[href]:focus {
  color: #fff;
  text-decoration: none;
  background-color: #545b62;
}

.badge-success {
  color: #fff;
  background-color: #28a745;
}

.badge-success[href]:hover, .badge-success[href]:focus {
  color: #fff;
  text-decoration: none;
  background-color: #1e7e34;
}

.badge-info {
  color: #fff;
  background-color: #17a2b8;
}

.badge-info[href]:hover, .badge-info[href]:focus {
  color: #fff;
  text-decoration: none;
  background-color: #117a8b;
}

.badge-warning {
  color: #212529;
  background-color: #ffc107;
}

.badge-warning[href]:hover, .badge-warning[href]:focus {
  color: #212529;
  text-decoration: none;
  background-color: #d39e00;
}

.badge-danger {
  color: #fff;
  background-color: #dc3545;
}

.badge-danger[href]:hover, .badge-danger[href]:focus {
  color: #fff;
  text-decoration: none;
  background-color: #bd2130;
}

.badge-light {
  color: #212529;
  background-color: #f8f9fa;
}

.badge-light[href]:hover, .badge-light[href]:focus {
  color: #212529;
  text-decoration: none;
  background-color: #dae0e5;
}

.badge-dark {
  color: #fff;
  background-color: #343a40;
}

.badge-dark[href]:hover, .badge-dark[href]:focus {
  color: #fff;
  text-decoration: none;
  background-color: #1d2124;
}

.invoice-box table tr.total td:nth-child(2) {
    border-top: 2px solid #eee;
    font-weight: bold;
}



.invoice-box table tr.footer td {
    color:orange;
    font-weight: bold;
    padding-bottom: 1px;

}

// @media only screen and (max-width: 600px) {
//     .invoice-box table tr.top table td {
//         width: 100%;
//         display: block;
//         text-align: center;
//     }
//
//     .invoice-box table tr.information table td {
//         width: 100%;
//         display: block;
//         text-align: center;
//     }
// }

/** RTL **/
.rtl {
    direction: rtl;
    font-family: Tahoma, 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
}

.rtl table {
    text-align: right;
}

.rtl table tr td:nth-child(2) {
    text-align: left;
}  
</style>
